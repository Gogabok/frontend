@import "~themes/_variables"

$backgroundSize = 120px
$minWidth = 310px
$minHeight = 500px
$borderRadius = 15px
$borderSize = 30px
$barHeight = 30px
$ghostUserSize = 70px
$callFooterHeight = 80px

.call
  position: fixed
  right: ($hSpacing * 0.5)
  top: ($vSpacing * 0.5)
  width: $minWidth
  height: $minHeight
  min-height: $minHeight
  min-width: $minWidth
  background-image: url("~assets/img/bg-gapopa.svg")
  background-size: $backgroundSize
  z-index: 3001
  border-radius: $borderRadius
  overflow: hidden
  user-select: none
  border: 1px solid var(--gray)
  box-shadow: 0 0 $vSpacing ($hSpacing * 0.5) rgba(0, 0, 0, 0.1)
  display: flex
  flex-direction: column

  &.fullscreen
    position: fixed
    top: 0
    right: 0
    bottom: 0
    left: 0
    width: 100vw
    height: calc(var(--vh, 1vh) * 100)
    border: none
    border-radius: 0

    .call__content
      border: none
      border-radius: 0

  &__bar
    height: $barHeight
    width: 100%
    padding: 0 ($hSpacing * 1.5)
    background-color: var(--white)
    border-radius: $borderRadius $borderRadius 0 0
    display: flex
    justify-content: space-between
    align-items: center

  &__title
    font-size: var(--smallFont)
    color: var(--graydarker)

  &__close-icon
    display: flex
    justify-content: center
    align-items: center

    svg
      width: round($iconSize * 0.72)
      height: @width
      transform: rotateZ(45deg)

  &__interlocutors
    display: grid
    grid-template-columns: repeat(auto-fit, minmax(50%, 1fr))
    grid-template-rows: 1fr
    grid-auto-rows: 1fr
    width: 100%
    height: 100%
    flex-shrink: 1
    position: relative

    .target-overlay
      display: flex
      justify-content: center
      align-items: center
      width: 100%
      height: 100%
      position: absolute
      top: 0
      left: 0
      background-color: var(--call-drag-target-background-color)
      z-index: 200
      opacity: 0
      transition: 0.2s ease-in-out opacity

      &.crop
        height: "calc(100% - %s)" % ($callFooterHeight)

      &:hover
        opacity: 1

      svg
        width: $iconSize
        height: @width
        fill: white
        stroke: white

  &__gradient
    position: absolute
    left: 0
    top: 0
    right: 0
    z-index: 1
    height: 100%
    pointer-events: none
    background: rgba(0, 0, 0, 0.4)

  &__content
    border-radius: 0 0 $borderRadius $borderRadius
    position: relative
    height: 100%
    overflow: hidden
    display: flex
    flex-direction: column

  &__ended-message
    position: absolute
    bottom: 25px
    left: 50%
    transform: translateX(-50%)
    font-size: var(--largeFont)
    z-index: 13
    text-align: center
    color: white

  &__overlay
    position: absolute
    left: 0
    top: 0
    right: 0
    bottom: 0
    background: var(--overlay-backplate)
    pointer-events: none


  &__border
    position: absolute

    &.left
      left: (- $hSpacing)
      top: 0
      bottom: 0
      width: $borderSize
      cursor: w-resize

    &.top
      top: (- $vSpacing)
      left: 0
      right: 0
      height: $borderSize
      cursor: n-resize

    &.right
      right: (- $hSpacing)
      top: 0
      bottom: 0
      width: $borderSize
      cursor: e-resize

    &.bottom
      bottom: (- $vSpacing)
      left: 0
      right: 0
      height: $borderSize
      cursor: s-resize



  &__corner
    width: $borderSize
    height: $borderSize
    position: absolute
    z-index: 11

    &-left-top
      left: (- $hSpacing)
      top: (- $vSpacing)
      cursor: nwse-resize

    &-right-top
      right: (- $hSpacing)
      top: (- $vSpacing)
      cursor: nesw-resize

    &.left.bottom
      left: (- $hSpacing)
      bottom: (- $vSpacing)
      cursor: nesw-resize

    &-right-bottom
      right: (- $hSpacing)
      bottom: (- $vSpacing)
      cursor: nwse-resize


.ghost-user
  width: $ghostUserSize
  height: @width
  position: fixed
  pointer-events: none
  transform: translate(-50%, -50%)
  overflow: hidden
  border-radius: 50%
  background-color: var(--white)
  z-index: 200

  img
    width: 100%
    height: 100%
    object-fit: cover
    object-position: center center


.is-mobile
  .call
    left: 0
    top: 0
    right: 0
    bottom: 0
    height: calc(var(--vh, 1vh) * 100)
    width: 100vw
    border: none
    border-radius: 0
    box-shadow: none
    min-height: unset
    min-width: unset

    &.minified
      overflow: hidden
      border-radius: ($borderRadius / 1.5)


    &__content
      border-radius: 0




.fade-up-enter-active
.fade-up-leave-active
  transition: all .3s ease

.fade-up-enter
.fade-up-leave-to
  transform: translateY(-100%)
  opacity 0


.fade-down-enter-active
.fade-down-leave-active
  transition: all .5s ease

.fade-down-enter
.fade-down-leave-to
  transform: translateY(100%)
  opacity: 0

.fade-down-center-enter-active
.fade-down-center-leave-active
  transition: all 0.5s ease

.fade-down-center-enter
.fade-down-center-leave-to
  transform: translate(-50%, 100%)
  opacity: 0
